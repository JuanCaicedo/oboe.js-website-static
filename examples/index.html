<!DOCTYPE html>
<html>
    <head>

       <meta name="viewport" content="width=device-width, initial-scale=1.0"/>

       <meta name="description" content="A streaming approach to JSON. Oboe.js is a Javascript library for Node.js and browsers that speeds up web applications by providing parsed objects before the response completes"/>

       <meta name="keywords" content="json streaming node.js browsers"/>

        <link rel="stylesheet" href="css/all.css">

        <title>Examples : Oboe.js</title>

       <link rel="icon" type="image/png" href="/favicons/favicon-32.png" sizes="32x32">
       <link rel="icon" type="image/png" href="/favicons/favicon-16.png" sizes="16x16">

    </head>
    <body >
        <div id="header">
        </div>
        <nav id="siteNav">
            <svg width="24" height="24" class="menuButton" >
                <rect class="background" width="24" height="24" />
                <rect class="rung" width="16" height="4" x="4" y="3"  />
                <rect class="rung" width="16"  height="4" x="4" y="10"  />
                <rect class="rung" width="16" height="4" x="4" y="17" />
            </svg>
           <ul>
              
              
                  <li class="reducedLogo"><a href="http://juancaicedo.github.io/oboe.js-website/">Oboe.js</a></li>
              

              
                  <li>
                     
                         <a class="siteLink" href="http://juancaicedo.github.io/oboe.js-website/why">why</a>
                     
                  </li>

              
                  <li>
                     
                         <a class="siteLink" href="http://juancaicedo.github.io/oboe.js-website/examples">examples</a>
                     
                  </li>

              
                  <li>
                     
                         <a class="siteLink" href="http://juancaicedo.github.io/oboe.js-website/api">api</a>
                     
                  </li>

              
                  <li>
                     
                         <a class="siteLink" href="http://juancaicedo.github.io/oboe.js-website/download">download</a>
                     
                  </li>

              
                  <li>
                     
                         <a class="siteLink" href="http://juancaicedo.github.io/oboe.js-website/discuss">discuss</a>
                     
                  </li>

              
                  <li>
                     
                         <a class="siteLink" href="http://juancaicedo.github.io/oboe.js-website/"></a>
                     
                  </li>

              
           </ul>
        </nav>
        <div id="pagearea">
           <header class="row">
              
              
                  <h1><a href="http://juancaicedo.github.io/oboe.js-website/">Oboe.js</a></h1>
              

              
           </header>

           <div class="row">

              <nav class="col col1">

                 

                 
                    
                       <div class="internalNav">
                          <h2>Examples</h2>
                          
                             <ul class="sections">
                                
                                   <li><a href="#a-simple-download">A simple download</a></li>
                                
                                   <li><a href="#extracting-objects-from-the-json-stream">Extracting objects from the JSON stream</a></li>
                                
                                   <li><a href="#duck-typing">Duck typing</a></li>
                                
                                   <li><a href="#hanging-up-when-we-have-what-we-need">Hanging up when we have what we need</a></li>
                                
                                   <li><a href="#detecting-strings-numbers">Detecting strings, numbers</a></li>
                                
                                   <li><a href="#reacting-before-we-get-the-whole-object">Reacting before we get the whole object</a></li>
                                
                                   <li><a href="#giving-some-visual-feedback-as-a-page-is-updating">Giving some visual feedback as a page is updating</a></li>
                                
                                   <li><a href="#taking-meaning-from-a-node-s-location">Taking meaning from a node&#x27;s location</a></li>
                                
                                   <li><a href="#deregistering-a-callback">Deregistering a callback</a></li>
                                
                                   <li><a href="#css4-style-patterns">Css4 style patterns</a></li>
                                
                                   <li><a href="#transforming-json-while-it-is-streaming">Transforming JSON while it is streaming</a></li>
                                
                                   <li><a href="#demarshalling-json-to-an-oop-model">Demarshalling JSON to an OOP model</a></li>
                                
                                   <li><a href="#loading-json-trees-larger-than-the-available-ram">Loading JSON trees larger than the available RAM</a></li>
                                
                                   <li><a href="#streaming-out-html-from-express">Streaming out HTML from express</a></li>
                                
                                   <li><a href="#using-oboe-with-d3-js">Using Oboe with d3.js</a></li>
                                
                                   <li><a href="#reading-from-node-js-streams">Reading from Node.js streams</a></li>
                                
                                   <li><a href="#rolling-back-on-error">Rolling back on error</a></li>
                                
                                   <li><a href="#example-patterns">Example patterns</a></li>
                                
                             </ul>
                          
                       </div>
                    
                 

                 
              </nav>
              <div class="col col2">

                 <main class="marked">
                    
<h2 id="a-simple-download">A simple download</h2>
<p>It isn&#39;t what Oboe was built for but it works fine as a simple AJAX library.
This might be a good tactic to drop it into an existing application before iteratively refactoring
towards progressive loading. The call style should be familiar to jQuery users.</p>
<pre><code class="lang-js">oboe(&#39;/myapp/things.json&#39;)
   .done(function(things) {

      // we got it
   })
   .fail(function() {

      // we don&#39;t got it
   });
</code></pre>
<h2 id="extracting-objects-from-the-json-stream">Extracting objects from the JSON stream</h2>
<p>Say we have a resource called things.json that we need to fetch:</p>
<pre><code class="lang-js">{
   &quot;foods&quot;: [
      {&quot;name&quot;:&quot;aubergine&quot;,    &quot;colour&quot;:&quot;purple&quot;},
      {&quot;name&quot;:&quot;apple&quot;,        &quot;colour&quot;:&quot;red&quot;},
      {&quot;name&quot;:&quot;nuts&quot;,         &quot;colour&quot;:&quot;brown&quot;}
   ],
   &quot;badThings&quot;: [
      {&quot;name&quot;:&quot;poison&quot;,       &quot;colour&quot;:&quot;pink&quot;},
      {&quot;name&quot;:&quot;broken_glass&quot;, &quot;colour&quot;:&quot;green&quot;}
   ]
}
</code></pre>
<p>On the client side we want to download and use this JSON. Running the
code below, each item will be logged as soon as it is transferred
without waiting for the whole download to complete.</p>
<pre><code class="lang-js">oboe(&#39;/myapp/things.json&#39;)
   .node(&#39;foods.*&#39;, function( foodThing ){

      // This callback will be called everytime a new object is
      // found in the foods array.

      console.log( &#39;Go eat some&#39;, foodThing.name);
   })
   .node(&#39;badThings.*&#39;, function( badThing ){

      console.log( &#39;Stay away from&#39;, badThing.name);
   })
   .done(function(things){

      console.log(
         &#39;there are&#39;, things.foods.length, &#39;things to eat&#39;,
         &#39;and&#39;, things.nonFoods.length, &#39;to avoid&#39;);
   });
</code></pre>
<h2 id="duck-typing">Duck typing</h2>
<p>Sometimes it is easier to say <em>what you are trying to find</em> than <em>where you&#39;d like to find it</em>.
<a href="http://en.wikipedia.org/wiki/Duck_typing">Duck typing</a> is provided for these cases.</p>
<pre><code class="lang-js">oboe(&#39;/myapp/things.json&#39;)
   .node(&#39;{name colour}&#39;, function( thing ) {
      // I&#39;ll be called for every object found that
      // has both a name and a colour
      console.log(thing.name, &#39; is &#39;, thing.colour);
   };
</code></pre>
<h2 id="hanging-up-when-we-have-what-we-need">Hanging up when we have what we need</h2>
<p>If you don&#39;t control the data source the service sometimes returns more information than your
application actually needs.</p>
<p>If we only care about the foods and not the non-foods we
can hang up as soon as we have the foods, reducing our precious
download footprint.</p>
<pre><code class="lang-js">oboe(&#39;/myapp/things.json&#39;)
   .node({
      &#39;foods.*&#39;: function( foodObject ){

         alert(&#39;go ahead and eat some &#39; + foodObject.name);
      },
      &#39;foods&#39;: function(){
         // We have everything that we need. That&#39;s enough.
         this.abort();
      }
   });
</code></pre>
<h2 id="detecting-strings-numbers">Detecting strings, numbers</h2>
<p>Want to detect strings or numbers instead of objects? Oboe doesn&#39;t care about node
types so the syntax is the same:</p>
<pre><code class="lang-js">oboe(&#39;/myapp/things.json&#39;)
   .node({
      &#39;colour&#39;: function( colour ){
         // (colour instanceof String) === true
      }
   });
</code></pre>
<h2 id="reacting-before-we-get-the-whole-object">Reacting before we get the whole object</h2>
<p>As well as <code>node</code> events, you can listen on <code>path</code> events which fire when
locations in the JSON are found, before we know what will be found there.
Here we eagerly create elements before we have their content
so that the page updates as soon as possible:</p>
<pre><code class="lang-js">var currentPersonElement;
oboe(&#39;people.json&#39;)
   .path(&#39;people.*&#39;, function(){
      // we don&#39;t have the person&#39;s details yet but we know we
      // found someone in the json stream. We can eagerly put
      // their div to the page and then fill it with whatever
      // other data we find:
      currentPersonElement = $(&#39;&lt;div class=&quot;person&quot;&gt;&#39;);
      $(&#39;#people&#39;).append(currentPersonElement);
   })
   .node({
      &#39;people.*.name&#39;: function( name ){
         // we just found out their name, lets add it
         // to their div:
         currentPersonElement.append(
            &#39;&lt;span class=&quot;name&quot;&gt;&#39; + name + &#39;&lt;/span&gt;&#39;);
      },
      &#39;people.*.email&#39;: function( email ){
         // we just found out their email, lets add
         // it to their div:
         currentPersonElement.append(
            &#39;&lt;span class=&quot;email&quot;&gt;&#39; + email + &#39;&lt;/span&gt;&#39;);
      }
   });
</code></pre>
<h2 id="giving-some-visual-feedback-as-a-page-is-updating">Giving some visual feedback as a page is updating</h2>
<p>Suppose we&#39;re using progressive rendering to go to the next &#39;page&#39; in a dashboard-style single page webapp
and want to put some kind of indication on the page as individual modules load.</p>
<p>We use a spinner to give visual feedback when an area of the page is loading and remove it
when we have the data for that area.</p>
<pre><code class="lang-js">// JSON from the server side:
{
   &#39;progress&#39;:[
      &#39;faster loading&#39;,
      &#39;maintainable velocity&#39;,
      &#39;more beer&#39;
   ],
   &#39;problems&#39;:[
      &#39;technical debt&#39;,
      &#39;team drunk&#39;
   ]
}
</code></pre>
<pre><code class="lang-js">MyApp.showSpinnerAt(&#39;#progress&#39;);
MyApp.showSpinnerAt(&#39;#problems&#39;);

oboe(&#39;/agileReport/sprint42&#39;)
   .node({
      &#39;!.progress.*&#39;: function( itemText ){
         $(&#39;#progress&#39;)
            .append(&#39;&lt;div&gt;&#39;)
            .text(&#39;We made progress in &#39; + itemText);
      },
      &#39;!.progress&#39;: function(){
         MyApp.hideSpinnerAt(&#39;#progress&#39;);
      },
      &#39;!.problems.*&#39;: function( itemText ){
         $(&#39;#problems&#39;)
            .append(&#39;&lt;div&gt;&#39;)
            .text(&#39;We had problems with &#39; + itemText);
      },
      &#39;!.problems&#39;: function(){
         MyApp.hideSpinnerAt(&#39;#problems&#39;);
      }
   });
</code></pre>
<h2 id="taking-meaning-from-a-node-s-location">Taking meaning from a node&#39;s location</h2>
<p>Node and path callbacks receive a description of where items are found
as an array of strings describing the path from the JSON root.
It is sometimes preferable to
register a wide-matching pattern and use the item&#39;s location to
decide programmatically what to do with it.</p>
<pre><code class="lang-js">// JSON data for homepage of a social networking site.
// Each top-level object is for a different module on the page.
{  &quot;notifications&quot;:{
      &quot;newNotifications&quot;: 2,
      &quot;totalNotifications&quot;: 8
   },
   &quot;messages&quot;: [
      {  &quot;from&quot;:&quot;Joe&quot;,
         &quot;subject&quot;:&quot;Wanna go fishing?&quot;,
         &quot;url&quot;:&quot;messages/1&quot;
      },
      {  &quot;from&quot;:&quot;Baz&quot;,
         &quot;subject&quot;:&quot;Hello&quot;,
         &quot;url&quot;:&quot;messages/2&quot;
      }
   ],
   &quot;photos&quot;: {
      &quot;new&quot;: [
         {  &quot;title&quot;: &quot;Birthday Party&quot;,
            &quot;url&quot;:&quot;/photos/5&quot;,
            &quot;peopleTagged&quot;:[&quot;Joe&quot;,&quot;Baz&quot;]
         }
      ]
   }
   // ... other modules ...
}
</code></pre>
<pre><code class="lang-js">oboe(&#39;http://mysocialsite.example.com/homepage&#39;)
   .node(&#39;!.*&#39;, function( moduleJson, path ){

      // This callback will be called with every direct child
      // of the root object but not the sub-objects therein.
      // Because we&#39;re maching direct children of the root the
      // path argument is a single-element array with the module
      // name; it resembles [&#39;messages&#39;] or [&#39;photos&#39;].
      var moduleName = path[0];

      My.App
         .getModuleCalled(moduleName)
         .showNewData(moduleJson);
   });
</code></pre>
<h2 id="deregistering-a-callback">Deregistering a callback</h2>
<p>Calling <code>this.forget()</code> from inside a callback deregisters that listener.</p>
<pre><code class="lang-js">
// We have a list of items to plot on a map. We want to draw
// the first ten while they&#39;re loading. After that we want
// to store the rest in a model to be drawn later.

oboe(&#39;/listOfPlaces&#39;)
   .node(&#39;list.*&#39;, function( item, path ){
      var itemIndex = path[path.length-1];

      model.addItemToModel(item);
      view.drawItem(item);

      if( itemIndex == 10 ) {
         this.forget();
      }
   })
   .done(function( fullJson ){
      var undrawnItems = fullJson.list.slice(10);

      model.addItemsToModel(undrawnItems);
   });
</code></pre>
<h2 id="css4-style-patterns">Css4 style patterns</h2>
<p>Sometimes when downloading an array of items it isn&#39;t very useful to be given each element individually.
It is easier to integrate with libraries like <a href="http://angularjs.org/">Angular</a> if you&#39;re given an array
repeatedly whenever a new element is concatenated onto it.</p>
<p>Oboe supports css4-style selectors and gives them much the same meaning as in the
<a href="http://www.w3.org/TR/2011/WD-selectors4-20110929/#subject">proposed css level 4 selector spec</a>.</p>
<p>If a term is prefixed with a dollar sign, the node matching that term is explicitly selected,
even if the pattern as a whole matches a node further down the tree.</p>
<pre><code class="lang-js">// JSON
{&quot;people&quot;: [
   {&quot;name&quot;:&quot;Baz&quot;, &quot;age&quot;:34, &quot;email&quot;: &quot;baz@example.com&quot;}
   {&quot;name&quot;:&quot;Boz&quot;, &quot;age&quot;:24}
   {&quot;name&quot;:&quot;Bax&quot;, &quot;age&quot;:98, &quot;email&quot;: &quot;bax@example.com&quot;}}
]}
</code></pre>
<pre><code class="lang-js">// we are using Angular and have a controller:
function PeopleListCtrl($scope) {

   oboe(&#39;/myapp/things&#39;)
      .node(&#39;$people[*]&#39;, function( peopleLoadedSoFar ){

         // This callback will be called with a 1-length array,
         // a 2-length array, a 3-length array etc until the
         // whole thing is loaded.
         // Putting this array on the scope object under
         // Angular re-renders the list of people.

         $scope.people = peopleLoadedSoFar;
      });
}
</code></pre>
<p>Like css4 stylesheets, this can also be used to express a &#39;containing&#39; operator.</p>
<pre><code class="lang-js">oboe(&#39;/myapp/things&#39;)
   .node(&#39;people.$*.email&#39;, function(personWithAnEmailAddress){

      // here we&#39;ll be called back with baz
      // and bax but not Boz.

   });
</code></pre>
<h2 id="transforming-json-while-it-is-streaming">Transforming JSON while it is streaming</h2>
<p>Say we have the JSON below:</p>
<pre><code class="lang-js">[
   {&quot;verb&quot;:&quot;VISIT&quot;, &quot;noun&quot;:&quot;SHOPS&quot;},
   {&quot;verb&quot;:&quot;FIND&quot;, &quot;noun&quot;:&quot;WINE&quot;},
   {&quot;verb&quot;:&quot;MAKE&quot;, &quot;noun&quot;:&quot;PIZZA&quot;}
]
</code></pre>
<p>We want to read the JSON but the uppercase is a bit ugly.
Oboe can transform the nodes as they stream:</p>
<pre><code class="lang-js">
function toLower(s){
   return s.toLowerCase();
}

oboe(&#39;words.json&#39;)
   .node(&#39;verb&#39;, toLower)
   .node(&#39;noun&#39;, toLower)
   .node(&#39;!.*&#39;, function(pair){

      console.log(&#39;Please&#39;, pair.verb, &#39;me some&#39;, pair.noun);
   });
</code></pre>
<p>The code above logs:</p>
<pre><code>Please visit me some shops
Please find me some wine
Please make me some pizza
</code></pre><h2 id="demarshalling-json-to-an-oop-model">Demarshalling JSON to an OOP model</h2>
<p>If you are programming in an OO style you probably want to instantiate constructors
based on the values you read from the JSON.</p>
<p>You can build the OOP model while streaming using Oboe&#39;s node replacement feature:</p>
<pre><code class="lang-js">function Person(firstName, lastName) {
   this.firstName = firstName;
   this.lastName = lastName;
}

Person.prototype.getFullName = function() {
   return this.firstName + &#39; &#39; + this.lastName;
}

oboe(&#39;/myapp/people&#39;)
   .node(&#39;people.*&#39;, function(person){

      // Any value we return from a node callback will replace
      // the parsed object:

      return new Person(person.firstName, person.lastName)
   })
   .done(function(model){

      // We can call the .getFullName() method directly because the
      // model here contains Person instances, not plain JS objects

      console.log( model.people[1].getFullName() );
   });
</code></pre>
<h2 id="loading-json-trees-larger-than-the-available-ram">Loading JSON trees larger than the available RAM</h2>
<p>By default Oboe assembles the full tree of the JSON that it receives.
This means that every node is kept in memory for the duration of the parse.</p>
<p>If you are streaming large resources to avoid memory limitations, you can delete
any detected node by returning <code>oboe.drop</code> from <a href="api#node-event">the node event</a>.</p>
<pre><code class="lang-js">// we are getting this large JSON
{
   &quot;drinks&quot;:[
      {&quot;name&quot;:&quot;Orange juice&quot;, &quot;ingredients&quot;:&quot;Oranges&quot;},
      {&quot;name&quot;:&quot;Wine&quot;, &quot;ingredients&quot;:&quot;Grapes&quot;},
      {&quot;name&quot;:&quot;Coffee&quot;, &quot;ingredients&quot;:&quot;Roasted Beans&quot;}

      // ... lots more records ...
   ]
}
</code></pre>
<pre><code class="lang-js">oboe(&#39;drinks.json&#39;)
   .node(&#39;!.*&#39;, function(drink){

      if( available(drink.ingredients) ) {
         startMaking(drink.name);
      }

      // By returning oboe.drop, the parsed JSON object will be freed,
      // allowing it to be garbage collected.
      return oboe.drop;

   }).done(function( finalJson ){

      // most of the nodes have been dropped

      console.log( finalJson );  // logs: {&quot;drinks&quot;:[]}
   })
</code></pre>
<p>There is also a shorthand form of <code>oboe.drop</code> if you want to drop nodes without examining them first:</p>
<pre><code class="lang-js">oboe(&#39;drinks.json&#39;)
   // we don&#39;t care how the drink is made
   .node(&#39;ingredients&#39;, oboe.drop)
   .done(function( finalJson ){

      console.log( finalJson.drinks );
      //  [ {&quot;name&quot;:&quot;Orange juice&quot;}, {&quot;name&quot;:&quot;Wine&quot;}, {&quot;name&quot;:&quot;Coffee&quot;} ]}
   })
</code></pre>
<h2 id="streaming-out-html-from-express">Streaming out HTML from express</h2>
<p>Generating a streamed HTML response from a streamed JSON data service.</p>
<pre><code class="lang-js">app.get(&#39;/foo&#39;, function(req, res){
   function writeHtml(err, html){
      res.write(html);
   }

   res.render(&#39;pageheader&#39;, writeHtml);

   oboe( my_stream )
      .node(&#39;items.*&#39;, function( item ){
          res.render(&#39;item&#39;, item, writeHtml);
      })
      .done(function() {
          res.render(&#39;pagefooter&#39;, writeHtml);
      })
});
</code></pre>
<h2 id="using-oboe-with-d3-js">Using Oboe with d3.js</h2>
<p>Oboe works very nicely with <a href="http://d3js.org/">d3.js</a> to add content to
a visualisation while the JSON downloads.</p>
<pre><code class="lang-js">// get a (probably empty) d3 selection:
var things = d3.selectAll(&#39;rect.thing&#39;);

// Start downloading some data.
// Every time we see a new thing in the data stream, use
// d3 to add an element to our visualisation. This pattern
// should work for most d3 based visualistions.
oboe(&#39;/data/things&#39;)
   .node(&#39;$things.*&#39;, function( thingsArray ){

      things.data(thingsArray)
         .enter().append(&#39;svg:rect&#39;)
            .classed(&#39;thing&#39;, true)
            .attr(x, function(d){ return d.x })
            .attr(y, function(d){ return d.x })
            .attr(width, function(d){ return d.w })
            .attr(height, function(d){ return d.h })

      // no need to handle update or exit set here since
      // downloading is purely additive
   });
</code></pre>
<h2 id="reading-from-node-js-streams">Reading from Node.js streams</h2>
<p>Instead of giving <code>oboe</code> a URL you can pass any <a href="http://nodejs.org/api/stream.html#stream_class_stream_readable">ReadableStream</a>.
To load from a local file you&#39;d do this:</p>
<pre><code class="lang-js">oboe( fs.createReadStream( &#39;/home/me/secretPlans.json&#39; ) )
   .on(&#39;node&#39;, {
      &#39;schemes.*&#39;: function(scheme){
         console.log(&#39;Aha! &#39; + scheme);
      },
      &#39;plottings.*&#39;: function(deviousPlot){
         console.log(&#39;Hmmm! &#39; + deviousPlot);
      }
   })
   .on(&#39;done&#39;, function(){
      console.log(&quot;*twiddles mustache*&quot;);
   })
   .on(&#39;fail&#39;, function(){
      console.log(&quot;Drat! Foiled again!&quot;);
   });
</code></pre>
<p>Because explicit loops are replaced with pattern-based declarations,
the code is usually about the same length as with JSON.parse:</p>
<pre><code class="lang-js">fs.readFile(&#39;/home/me/secretPlans.json&#39;,
   function(err, plansJson){
      if(err) {
         console.log(&quot;Drat! Foiled again!&quot;);
         return;
      }
      var plans = JSON.parse(plansJson);

      plans.schemes.forEach(function(scheme){
         console.log(&#39;Aha! &#39; + scheme);
      });
      plans.plottings.forEach(function(deviousPlot){
         console.log(&#39;Hmmm! &#39; + deviousPlot);
      });

      console.log(&quot;*twiddles mustache*&quot;);
   });
</code></pre>
<h2 id="rolling-back-on-error">Rolling back on error</h2>
<p><a href="api#fail-event">The fail event</a> notifies when something goes wrong.
If you have started putting elements on the page and the connection
goes down you have a few options</p>
<ul>
<li>If the new elements you added are useful without the rest, leave them. For example, in a web-based email client it is more useful to show some messages than none. See <a href="why#demo-mobile-fail-progressive">dropped connections visualisation</a>.</li>
<li>If they are useful but you need the rest, make a new request. If the service supports it you need only ask for the missing items.</li>
<li>Rollback any half-done changes.</li>
</ul>
<p>The example below implements rollback.</p>
<pre><code class="lang-js">var currentPersonElement;
oboe(&#39;everyone&#39;)
   .path(&#39;people.*&#39;, function(){
      // we don&#39;t have the person&#39;s details yet but we know we
      // found someone in the json stream, we can use this to
      // eagerly add them to the page:
      currentPersonElement = $(&#39;&lt;div class=&quot;person&quot;&gt;&#39;);
      $(&#39;#people&#39;).append(currentPersonElement);
   })
   .node(&#39;people.*.name&#39;, function( name ){
      // we just found out that person&#39;s name, lets add it to
      // their div:
      var markup = &#39;&lt;span class=&quot;name&quot;&gt;&#39; + name + &#39;&lt;/span&gt;&#39;;
      currentPersonElement.append(markup);
   })
   .fail(function(){
      if( currentPersonElement ) {
         // oops, that didn&#39;t go so well. instead of leaving
         // this dude half on the page, remove them altogether
         currentPersonElement.remove();
      }
   })
</code></pre>
<h2 id="example-patterns">Example patterns</h2>
<table>
<thead>
<tr>
<th>Pattern</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>*</code></td>
<td>Every object, string, number etc found in the json stream</td>
</tr>
<tr>
<td><code>!</code></td>
<td>The root object. Fired when the whole response is available, like JSON.parse()</td>
</tr>
<tr>
<td><code>!.foods.colour</code></td>
<td>The colours of the foods</td>
</tr>
<tr>
<td><code>person.emails[1]</code></td>
<td>The first element in the email array for each person</td>
</tr>
<tr>
<td><code>{name email}</code></td>
<td>Any object with a name and an email property, regardless of where it is in the document</td>
</tr>
<tr>
<td><code>person.emails[*]</code></td>
<td>Any element in the email array for each person</td>
</tr>
<tr>
<td><code>person.$emails[*]</code></td>
<td>Any element in the email array for each person, but the callback will be passed the array so far rather than the array elements as they are found.</td>
</tr>
<tr>
<td><code>person</code></td>
<td>All people in the json, nested at any depth</td>
</tr>
<tr>
<td><code>person.friends.*.name</code></td>
<td>Detecting friend names in a social network</td>
</tr>
<tr>
<td><code>person.friends..{name}</code></td>
<td>Detecting friends with names in a social network</td>
</tr>
<tr>
<td><code>person..email</code></td>
<td>Email addresses anywhere as descendant of a person object</td>
</tr>
<tr>
<td><code>person..{email}</code></td>
<td>Any object with an email address relating to a person in the stream</td>
</tr>
<tr>
<td><code>$person..email</code></td>
<td>Any person in the json stream with an email address</td>
</tr>
</tbody>
</table>

                 </main>

              </div>

           </div>
        </div>
        <footer>
           <div id="footer-contents">
              <a class="contact" href="mailto:jim.higson@gmail.com">Contact the author</a>

              <span id="externalLinks">
                  <a href="https://twitter.com/OboeJs">
                     <svg width="" height="">
                        <path class="logo" d="M 44 6.6 C 37 6.6 31.2 12.4 31.2 19.4 C 31.2 20.4 31.3 21.4 31.5 22.3 C 20.9 21.8 11.4 16.7 5.1 8.9 C 4 10.8 3.4 13.1 3.4 15.4 C 3.4 19.9 5.6 23.8 9.1 26.1 C 7 26 5 25.4 3.3 24.5 C 3.2 24.5 3.3 24.6 3.3 24.6 C 3.3 30.8 7.7 36 13.5 37.2 C 12.5 37.5 11.3 37.7 10.2 37.7 C 9.3 37.7 8.5 37.6 7.8 37.4 C 9.4 42.5 14.1 46.2 19.7 46.3 C 15.3 49.8 9.8 51.8 3.8 51.8 C 2.8 51.8 1.8 51.7 0.8 51.6 C 6.4 55.3 13.2 57.4 20.4 57.4 C 44 57.4 56.9 37.9 56.9 20.9 C 56.9 20.4 56.9 19.8 56.8 19.3 C 59.3 17.4 61.5 15.2 63.3 12.6 C 61 13.6 58.5 14.3 55.9 14.6 C 58.5 13 60.6 10.5 61.5 7.5 C 59.1 9 56.3 10.1 53.4 10.7 C 51 8.2 47.7 6.6 44 6.6 z"/>
                     </svg>
                  </a>

                  <a href="https://github.com/jimhigson/oboe.js">
                     <svg width="" height="">
                        <path class="logo" d="M 32,1.3 C 15,1.3 1.3,15 1.3,32 1.3,49 15,62.7 32,62.7 49,62.7 62.7,49 62.7,32 62.7,15 49,1.3 32,1.3 z m 0,4.9 c 3.5,0 6.9,0.7 10,2 3.1,1.3 5.8,3.1 8.2,5.5 2.4,2.4 4.2,5.1 5.5,8.2 1.3,3.2 2,6.5 2,10 0,3.5 -0.7,6.9 -2,10 -1.3,3.1 -3.2,5.8 -5.5,8.2 -2.4,2.4 -5.1,4.2 -8.2,5.5 -0.8,0.3 -1.6,0.6 -2.4,0.9 l 0,-4.6 c 0,-2.4 -0.8,-4.2 -2.5,-5.3 1,-0.1 2,-0.3 2.9,-0.4 0.9,-0.2 1.8,-0.4 2.8,-0.8 1,-0.3 1.9,-0.7 2.6,-1.2 0.8,-0.5 1.5,-1.1 2.2,-1.8 0.7,-0.7 1.3,-1.6 1.8,-2.5 0.5,-0.9 0.8,-2.1 1.1,-3.4 0.3,-1.3 0.4,-2.8 0.4,-4.4 0,-3.1 -1,-5.8 -3,-7.9 C 48.9,21.8 48.7,19.2 47.6,16.3 L 46.9,16.3 c -0.5,-0.1 -1.4,0.2 -2.8,0.7 C 42.7,17.4 41.2,18.2 39.5,19.4 c -2.4,-0.7 -4.8,-1 -7.4,-1 -2.6,0 -5,0.3 -7.4,1 -1.1,-0.7 -2.1,-1.3 -3,-1.8 -0.9,-0.5 -1.7,-0.8 -2.3,-1 -0.6,-0.2 -1.1,-0.3 -1.6,-0.3 -0.5,0 -0.8,-0.1 -0.9,0 -0.1,0 -0.3,0 -0.3,0.1 -1.1,2.8 -1.2,5.4 -0.3,7.8 -2,2.2 -3,4.8 -3,7.9 0,1.6 0.1,3 0.4,4.4 0.3,1.3 0.7,2.5 1.2,3.4 0.5,0.9 1.1,1.8 1.8,2.5 0.7,0.7 1.4,1.4 2.2,1.8 0.8,0.5 1.6,0.8 2.6,1.2 1,0.3 1.9,0.6 2.8,0.8 0.9,0.2 1.8,0.3 2.8,0.4 -1.6,1.1 -2.5,2.9 -2.5,5.3 l 0,4.7 C 23.7,56.4 22.8,56.1 22,55.8 18.9,54.5 16.2,52.6 13.8,50.2 11.4,47.8 9.5,45.1 8.3,42 6.9,38.9 6.2,35.5 6.2,32 6.2,28.5 6.9,25.1 8.3,22 9.5,18.9 11.4,16.1 13.8,13.8 16.2,11.4 18.9,9.5 22,8.3 25.1,6.9 28.5,6.2 32,6.2 z"/>
                     </svg>
                  </a>

                  <a href="https://groups.google.com/forum/#!forum/oboejs">
                     <svg width="" height="">
                        <path class="logo" d="M 34.7 4.1 C 29.7 4.1 24.6 4.9 20 7.3 C 18.1 8.3 16.7 9.3 15.4 10.3 C 11.9 12.9 10.1 15.5 8.6 17.6 C 7.1 19.8 5.9 23.2 5.4 24.7 C 4.8 26.5 4.7 28.3 4.5 30.2 C 4.3 31.4 4.3 32.7 4.4 34.1 C 4.5 37.2 5.2 40.6 6.7 43.8 C 7.8 46.1 9.2 48.3 10.7 50.3 C 13 53.6 16.8 55.7 19 56.8 C 20.7 57.7 22.9 58.7 26.6 59.3 C 30.7 60 36.9 60 46.7 58.4 C 49.4 58 52.4 57.1 55.8 56.4 C 56 56.4 56.2 56.3 56.4 56.2 C 56.6 56.2 56.8 56.2 56.8 56.1 C 56.6 51.7 56.7 46.8 56.8 44.6 C 56.8 44.3 56.8 43.2 56.8 42.8 C 56.8 42.4 57 42.5 57.3 42.3 L 59.3 40.3 L 43.3 40 L 37.8 43.2 L 48.8 42.7 L 48.8 55 C 48.8 55 44.4 56.9 38.3 56.8 C 33.9 56.7 28.6 55.7 23.5 51.8 C 15.4 45.7 12.6 37.3 12.5 31.3 C 12.5 28.2 12.4 25.9 12.7 24.9 C 12.9 24 13.2 21.9 14.2 19.7 C 15.4 16.6 17.5 13.3 21.4 10.7 C 23.8 9 27 7.5 30.8 7.2 C 35.1 6.8 38.2 7.3 40.8 8.3 C 47.1 10.8 48.4 12.8 49.3 13.6 C 49.3 13.6 49.5 13.8 49.5 13.9 C 49.4 14 49.4 14.1 49.3 14.2 C 48.9 14.9 47.8 16.8 47.8 16.8 L 50.2 16.6 L 56.6 10.3 C 56.8 10 51.1 6.2 43.1 4.8 C 40.5 4.4 37.6 4.1 34.7 4.1 z"/>
                     </svg>
                  </a>
              </span>

              <a href="//samwakeling.com" id="sw" title="Web design by Sam Wakeling">Web
                 design by Sam Wakeling
              </a>
           </div>
        </footer>

        

        
           <script src="/jquery/jquery.js"></script>
        

        
        

        

        <script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

            ga('create', '', 'oboejs.com');
            ga('send', 'pageview');
        </script>
    </body>
</html>
