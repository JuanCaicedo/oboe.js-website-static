<!DOCTYPE html>
<html>
    <head>

       <meta name="viewport" content="width=device-width, initial-scale=1.0"/>

       <meta name="description" content="A streaming approach to JSON. Oboe.js is a Javascript library for Node.js and browsers that speeds up web applications by providing parsed objects before the response completes"/>

       <meta name="keywords" content="json streaming node.js browsers"/>

        <link rel="stylesheet" href="css/all.css">

        <title> : Oboe.js</title>

       <link rel="icon" type="image/png" href="/favicons/favicon-32.png" sizes="32x32">
       <link rel="icon" type="image/png" href="/favicons/favicon-16.png" sizes="16x16">

    </head>
    <body >
        <div id="header">
        </div>
        <nav id="siteNav">
            <svg width="24" height="24" class="menuButton" >
                <rect class="background" width="24" height="24" />
                <rect class="rung" width="16" height="4" x="4" y="3"  />
                <rect class="rung" width="16"  height="4" x="4" y="10"  />
                <rect class="rung" width="16" height="4" x="4" y="17" />
            </svg>
           <ul>
              
              
                  <li class="reducedLogo"><a href="/">Oboe.js</a></li>
              

              
           </ul>
        </nav>
        <div id="pagearea">
           <header class="row">
              
              
                  <h1><a href="/">Oboe.js</a></h1>
              

              
           </header>

           <div class="row">

              <nav class="col col1">

                 

                 
                    
                 

                 
              </nav>
              <div class="col col2">

                 <main class="marked">
                    <h1 id="why-oboe-js-">Why Oboe.js?</h1>
<p>This page was written to show how streaming can speed up applications. The examples
illustrated show web interfaces using AJAX to pull in new data but the same techniques
would apply equally well anywhere that REST is used.</p>
<h2 id="stream-any-json-rest-resource">Stream any JSON REST resource</h2>
<p>Let&#39;s start by examining the standard pattern found on most AJAX-powered sites.
We have a client-side web application and a service that provides it with data.
The page isn&#39;t updated until the response completes:</p>
<p>{{demo &quot;fast-ajax-discrete&quot;}}</p>
<p>Oboe is different from most streaming JSON libraries since the JSON
does not have to follow a special format.
On a good connection there isn&#39;t a lot of time to save but
it is likely that <a href="http://www.sigchi.org/chi95/proceedings/shortppr/egd_bdy.htm">progressive display in itself will improve the <em>perception</em> of
performance</a>:</p>
<p>{{demo &quot;fast-ajax-progressive&quot;}}</p>
<p>With a slower connection or larger data the improvement
is more significant.</p>
<h2 id="transmit-fluently-over-mobile">Transmit fluently over mobile</h2>
<p>Mobile networks today are high-bandwidth but can also be
high-latency and come with inconsistent packet delivery times.
This is why buffered content like streaming <abbr title="high definition">HD</abbr> video plays
fluidly but web surfing still feels laggy. The visualisation
below approximates a medium-sized download on a mobile network:</p>
<p>{{demo &quot;mobile-discrete&quot;}}</p>
<p>Oboe.js makes it easy for the programmer to use chunks from the response as soon
as they arrive. This helps webapps to feel faster when running over mobile networks:</p>
<p>{{demo &quot;mobile-progressive&quot;}}</p>
<h2 id="handle-dropped-connections-with-grace">Handle dropped connections with grace</h2>
<p>Oboe.js provides improved tolerance if a connection is lost before
the response completes.
Most AJAX frameworks equate a dropped connection with total failure and discard
the partially transferred data, even if 90% was received correctly.</p>
<p>We can handle this situation better by using the partially transferred data
instead of throwing it away. Given an incremental approach to parsing, using partial data
follows naturally without requiring any extra programming.</p>
<p>In the next visualisation we have a mobile connection which fails when the
user enters a building:</p>
<p>{{demo &quot;mobile-fail-discrete&quot;}}</p>
<p>Because Oboe.js views the HTTP response as a
series of small, useful parts, when a connection is lost it is simply
the case that some parts were successful and were used already,
while others did not arrive. Fault tolerance comes for free.</p>
<p>In the example below the client is smart enough so that when the network
comes back it only requests the data that was missed on the first attempt:</p>
<p>{{demo &quot;mobile-fail-progressive&quot;}}</p>
<h2 id="streamline-resource-aggregation">Streamline resource aggregation</h2>
<p>It is a common pattern for web clients to retrieve data through a middle tier.
Nodes in the middle tier connect to multiple back-end services and
create a single, aggregated response by combining their data.</p>
<p>The visualisation below shows an example without streaming.
<span class="server2">Origin 1</span> is slower
than
<span class="server1">Origin 2</span>
but the
<span class="aggregator">aggregator</span> is forced to respond at the speed of
<span class="server2">the slowest service</span>:</p>
<p>{{demo &quot;aggregated-discrete&quot;}}</p>
<p>We can speed this scenario up by using Oboe.js to load data in
<span class="aggregator">the aggregator</span> and
<span class="place">the client</span>.
The aggregator dispatches the data as soon as it has it and
the client displays the data as soon as it is arrives.</p>
<p>{{demo &quot;aggregated-progressive&quot;}}</p>
<p>Despite being a stream,
<span class="aggregator">the aggregator&#39;s</span>
output is 100% valid JSON so it remains compatible
with standard AJAX tools. A client using a streaming parser like Oboe.js
consumes the resource as a stream but a more traditional client has no
problem reading it as a static resource.</p>
<p>In a Java stack this could also be implemented by using
<a href="http://code.google.com/p/google-gson/">GSON</a> in the middle tier.</p>
<h2 id="step-outside-the-trade-off-between-big-and-small-json">Step outside the trade-off between big and small JSON</h2>
<p>There is often a tradeoff using traditional REST clients:</p>
<ul>
<li>Request too much data and the application feels unresponsive because each request
takes some time to download.</li>
<li>Request less and, while the first data is handled earlier, more requests are needed,
meaning a greater http overhead and more time overall.</li>
</ul>
<p>Oboe.js breaks out of the tradeoff by beating both.
Large resources load just as responsively as smaller ones so the developer can request more
and let it stream.</p>
<p>In the visualisation below three rival clients
connect to <span class="place">the same server</span>. The
<span class="client1">top client requests a lot of data</span>,
<span class="client2">the middle a little data twice</span>, and
<span class="client3">the bottom a lot using Oboe.js</span>:</p>
<p>{{demo &quot;big-small&quot;}}</p>
<h2 id="send-historic-and-live-data-using-the-same-transport">Send historic and live data using the same transport</h2>
<p>It is a common pattern in web interfaces to fetch existing data
and then keep the page updated with &#39;live&#39; events as they happen.
We traditionally use two transports here but
wouldn&#39;t our day be easier if we didn&#39;t have to program distinct cases?</p>
<p>In the example below the message server intentionally writes a JSON response
that never completes. It starts by writing out the existing messages
as a chunk and then continues to write out new ones as they happen.
The only difference between &#39;old&#39; and &#39;new&#39; data is timing:</p>
<p>{{demo &quot;historic-and-live&quot;}}</p>
<h2 id="publish-cacheable-streamed-content">Publish cacheable, streamed content</h2>
<p><a href="#send-historic-and-live-data-using-the-same-transport">Above</a> we had a
service where the response intentionally never completes. Here we will
consider a slightly different case: JSON that streams to reflect
live events but which eventually ends.</p>
<p>Most streaming HTTP techniques like Websockets intentionally avoid caches
and proxies.
Oboe.js is different; by taking a REST-based approach to streaming it remains
compatible with HTTP intermediaries and can take advantage of caches to better
distribute the content.</p>
<p>The visualisation below is based on <a href="http://en.wikipedia.org/wiki/File:Cartogram%E2%80%942012_Electoral_Vote.svg">a cartogram taken from
Wikipedia</a>
and simulates each state&#39;s results being announced in the <a href="http://en.wikipedia.org/wiki/United_States_presidential_election,_2012">2012 United
States presidential
election</a>.
Time is sped up so that hours are condensed into seconds.</p>
<p>{{demo &quot;caching&quot;}}</p>
<p>This won&#39;t work for every use case. Websockets remains the better choice where
live data after-the-fact is no longer interesting. REST-based Cacheable streaming
works best for cases where the live data is not specific to a single user and remains
interesting as it ages.</p>
<h2 id="what-downsides-">What downsides?</h2>
<p>Because it is a pure Javascript parser, Oboe.js requires more CPU time
than JSON.parse. Oboe.js works marginally more
slowly for small messages that load very quickly
but for most real-world cases using i/o effectively beats optimising CPU time.</p>
<p>SAX parsers require less memory than Oboe&#39;s pattern-based parsing model because
they do not build up a parse tree. See <a href="parsers">Oboe.js vs SAX vs DOM</a>.</p>
<p>If in doubt, benchmark, but don&#39;t forget to
use the real internet, including mobile, and think about perceptual performance.</p>

                 </main>

              </div>

           </div>
        </div>
        <footer>
           <div id="footer-contents">
              <a class="contact" href="mailto:jim.higson@gmail.com">Contact the author</a>

              <span id="externalLinks">
                  <a href="https://twitter.com/OboeJs">
                     <svg width="" height="">
                        <path class="logo" d="M 44 6.6 C 37 6.6 31.2 12.4 31.2 19.4 C 31.2 20.4 31.3 21.4 31.5 22.3 C 20.9 21.8 11.4 16.7 5.1 8.9 C 4 10.8 3.4 13.1 3.4 15.4 C 3.4 19.9 5.6 23.8 9.1 26.1 C 7 26 5 25.4 3.3 24.5 C 3.2 24.5 3.3 24.6 3.3 24.6 C 3.3 30.8 7.7 36 13.5 37.2 C 12.5 37.5 11.3 37.7 10.2 37.7 C 9.3 37.7 8.5 37.6 7.8 37.4 C 9.4 42.5 14.1 46.2 19.7 46.3 C 15.3 49.8 9.8 51.8 3.8 51.8 C 2.8 51.8 1.8 51.7 0.8 51.6 C 6.4 55.3 13.2 57.4 20.4 57.4 C 44 57.4 56.9 37.9 56.9 20.9 C 56.9 20.4 56.9 19.8 56.8 19.3 C 59.3 17.4 61.5 15.2 63.3 12.6 C 61 13.6 58.5 14.3 55.9 14.6 C 58.5 13 60.6 10.5 61.5 7.5 C 59.1 9 56.3 10.1 53.4 10.7 C 51 8.2 47.7 6.6 44 6.6 z"/>
                     </svg>
                  </a>

                  <a href="https://github.com/jimhigson/oboe.js">
                     <svg width="" height="">
                        <path class="logo" d="M 32,1.3 C 15,1.3 1.3,15 1.3,32 1.3,49 15,62.7 32,62.7 49,62.7 62.7,49 62.7,32 62.7,15 49,1.3 32,1.3 z m 0,4.9 c 3.5,0 6.9,0.7 10,2 3.1,1.3 5.8,3.1 8.2,5.5 2.4,2.4 4.2,5.1 5.5,8.2 1.3,3.2 2,6.5 2,10 0,3.5 -0.7,6.9 -2,10 -1.3,3.1 -3.2,5.8 -5.5,8.2 -2.4,2.4 -5.1,4.2 -8.2,5.5 -0.8,0.3 -1.6,0.6 -2.4,0.9 l 0,-4.6 c 0,-2.4 -0.8,-4.2 -2.5,-5.3 1,-0.1 2,-0.3 2.9,-0.4 0.9,-0.2 1.8,-0.4 2.8,-0.8 1,-0.3 1.9,-0.7 2.6,-1.2 0.8,-0.5 1.5,-1.1 2.2,-1.8 0.7,-0.7 1.3,-1.6 1.8,-2.5 0.5,-0.9 0.8,-2.1 1.1,-3.4 0.3,-1.3 0.4,-2.8 0.4,-4.4 0,-3.1 -1,-5.8 -3,-7.9 C 48.9,21.8 48.7,19.2 47.6,16.3 L 46.9,16.3 c -0.5,-0.1 -1.4,0.2 -2.8,0.7 C 42.7,17.4 41.2,18.2 39.5,19.4 c -2.4,-0.7 -4.8,-1 -7.4,-1 -2.6,0 -5,0.3 -7.4,1 -1.1,-0.7 -2.1,-1.3 -3,-1.8 -0.9,-0.5 -1.7,-0.8 -2.3,-1 -0.6,-0.2 -1.1,-0.3 -1.6,-0.3 -0.5,0 -0.8,-0.1 -0.9,0 -0.1,0 -0.3,0 -0.3,0.1 -1.1,2.8 -1.2,5.4 -0.3,7.8 -2,2.2 -3,4.8 -3,7.9 0,1.6 0.1,3 0.4,4.4 0.3,1.3 0.7,2.5 1.2,3.4 0.5,0.9 1.1,1.8 1.8,2.5 0.7,0.7 1.4,1.4 2.2,1.8 0.8,0.5 1.6,0.8 2.6,1.2 1,0.3 1.9,0.6 2.8,0.8 0.9,0.2 1.8,0.3 2.8,0.4 -1.6,1.1 -2.5,2.9 -2.5,5.3 l 0,4.7 C 23.7,56.4 22.8,56.1 22,55.8 18.9,54.5 16.2,52.6 13.8,50.2 11.4,47.8 9.5,45.1 8.3,42 6.9,38.9 6.2,35.5 6.2,32 6.2,28.5 6.9,25.1 8.3,22 9.5,18.9 11.4,16.1 13.8,13.8 16.2,11.4 18.9,9.5 22,8.3 25.1,6.9 28.5,6.2 32,6.2 z"/>
                     </svg>
                  </a>

                  <a href="https://groups.google.com/forum/#!forum/oboejs">
                     <svg width="" height="">
                        <path class="logo" d="M 34.7 4.1 C 29.7 4.1 24.6 4.9 20 7.3 C 18.1 8.3 16.7 9.3 15.4 10.3 C 11.9 12.9 10.1 15.5 8.6 17.6 C 7.1 19.8 5.9 23.2 5.4 24.7 C 4.8 26.5 4.7 28.3 4.5 30.2 C 4.3 31.4 4.3 32.7 4.4 34.1 C 4.5 37.2 5.2 40.6 6.7 43.8 C 7.8 46.1 9.2 48.3 10.7 50.3 C 13 53.6 16.8 55.7 19 56.8 C 20.7 57.7 22.9 58.7 26.6 59.3 C 30.7 60 36.9 60 46.7 58.4 C 49.4 58 52.4 57.1 55.8 56.4 C 56 56.4 56.2 56.3 56.4 56.2 C 56.6 56.2 56.8 56.2 56.8 56.1 C 56.6 51.7 56.7 46.8 56.8 44.6 C 56.8 44.3 56.8 43.2 56.8 42.8 C 56.8 42.4 57 42.5 57.3 42.3 L 59.3 40.3 L 43.3 40 L 37.8 43.2 L 48.8 42.7 L 48.8 55 C 48.8 55 44.4 56.9 38.3 56.8 C 33.9 56.7 28.6 55.7 23.5 51.8 C 15.4 45.7 12.6 37.3 12.5 31.3 C 12.5 28.2 12.4 25.9 12.7 24.9 C 12.9 24 13.2 21.9 14.2 19.7 C 15.4 16.6 17.5 13.3 21.4 10.7 C 23.8 9 27 7.5 30.8 7.2 C 35.1 6.8 38.2 7.3 40.8 8.3 C 47.1 10.8 48.4 12.8 49.3 13.6 C 49.3 13.6 49.5 13.8 49.5 13.9 C 49.4 14 49.4 14.1 49.3 14.2 C 48.9 14.9 47.8 16.8 47.8 16.8 L 50.2 16.6 L 56.6 10.3 C 56.8 10 51.1 6.2 43.1 4.8 C 40.5 4.4 37.6 4.1 34.7 4.1 z"/>
                     </svg>
                  </a>
              </span>

              <a href="//samwakeling.com" id="sw" title="Web design by Sam Wakeling">Web
                 design by Sam Wakeling
              </a>
           </div>
        </footer>

        

        
           <script src="/jquery/jquery.js"></script>
        

        
        

        

        <script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

            ga('create', '', 'oboejs.com');
            ga('send', 'pageview');
        </script>
    </body>
</html>
